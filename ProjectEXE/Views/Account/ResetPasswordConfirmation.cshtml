@{
    ViewData["Title"] = "Xác nhận đặt lại mật khẩu";
}

@section Styles {
    <link rel="stylesheet" href="~/css/reset-password-confirmation.css?v=@DateTime.Now.Ticks" />
}

<div class="reset-success-page">
    <div class="container">
        <div class="success-wrapper">
            <div class="row justify-content-center">
                <div class="col-lg-5 col-md-6 col-sm-8">
                    <div class="success-card">
                        <!-- Success Animation -->
                        <div class="success-animation">
                            <div class="check-container">
                                <div class="success-circle">
                                    <div class="check-mark">
                                        <div class="check-line check-line-1"></div>
                                        <div class="check-line check-line-2"></div>
                                    </div>
                                </div>
                                <div class="success-confetti">
                                    <div class="confetti confetti-1"></div>
                                    <div class="confetti confetti-2"></div>
                                    <div class="confetti confetti-3"></div>
                                    <div class="confetti confetti-4"></div>
                                    <div class="confetti confetti-5"></div>
                                    <div class="confetti confetti-6"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Card Header -->
                        <div class="success-header">
                            <div class="header-icon">
                                <i class="fas fa-shield-check"></i>
                            </div>
                            <h3>Thành công!</h3>
                            <p class="header-subtitle">Đặt lại mật khẩu thành công</p>
                        </div>

                        <!-- Card Body -->
                        <div class="success-body">
                            <div class="message-content">
                                <div class="main-message">
                                    <h4>🎉 Mật khẩu của bạn đã được đặt lại!</h4>
                                    <p>Đặt lại mật khẩu thành công. Bạn có thể đăng nhập bằng mật khẩu mới của mình ngay bây giờ.</p>
                                </div>

                                <div class="success-status">
                                    <div class="status-card">
                                        <div class="status-icon">
                                            <i class="fas fa-key"></i>
                                        </div>
                                        <div class="status-content">
                                            <h5>Mật khẩu đã được cập nhật</h5>
                                            <p>Hệ thống đã xác nhận thay đổi mật khẩu của bạn</p>
                                            <div class="status-time">
                                                <i class="fas fa-clock"></i>
                                                <span id="successTime"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="next-actions">
                                    <h5>📱 Bước tiếp theo:</h5>
                                    <div class="action-list">
                                        <div class="action-item">
                                            <div class="action-icon">
                                                <i class="fas fa-sign-in-alt"></i>
                                            </div>
                                            <div class="action-content">
                                                <strong>Đăng nhập với mật khẩu mới</strong>
                                                <span>Sử dụng mật khẩu vừa tạo để truy cập tài khoản</span>
                                            </div>
                                        </div>
                                        <div class="action-item">
                                            <div class="action-icon">
                                                <i class="fas fa-mobile-alt"></i>
                                            </div>
                                            <div class="action-content">
                                                <strong>Cập nhật trên thiết bị khác</strong>
                                                <span>Nhớ cập nhật mật khẩu trên các thiết bị khác</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="security-tips">
                                    <div class="tips-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <div class="tips-content">
                                        <strong>💡 Mẹo bảo mật:</strong>
                                        <ul>
                                            <li>Không chia sẻ mật khẩu với bất kỳ ai</li>
                                            <li>Sử dụng mật khẩu khác nhau cho các tài khoản khác nhau</li>
                                            <li>Bật xác thực 2 bước nếu có thể</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Card Footer -->
                        <div class="success-footer">
                            <a asp-action="Login" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt"></i>
                                Đăng nhập ngay
                            </a>

                            <div class="additional-links">
                                <div class="link-group">
                                    <a href="#" class="support-link">
                                        <i class="fas fa-question-circle"></i>
                                        Cần hỗ trợ?
                                    </a>
                                    <span class="divider">•</span>
                                    <a href="#" class="support-link">
                                        <i class="fas fa-shield-alt"></i>
                                        Bảo mật tài khoản
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Security Card -->
                    <div class="security-card">
                        <div class="security-content">
                            <div class="security-icon">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="security-text">
                                <h6>Tài khoản được bảo vệ</h6>
                                <p>Mật khẩu của bạn đã được mã hóa và lưu trữ an toàn trong hệ thống của chúng tôi.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Set success time
            updateSuccessTime();

            // Trigger animations
            setTimeout(function() {
                document.querySelector('.success-card').classList.add('animate');
                document.querySelector('.success-animation').classList.add('animate');
            }, 300);

            // Start confetti animation
            setTimeout(function() {
                document.querySelector('.success-confetti').classList.add('animate');
            }, 800);
        });

        // Update success time display
        function updateSuccessTime() {
            const now = new Date();
            const timeString = now.toLocaleString('vi-VN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            const timeElement = document.getElementById('successTime');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // Auto redirect to login after delay
        setTimeout(function() {
            showRedirectNotification();
        }, 10000); // 10 seconds

        function showRedirectNotification() {
            const notification = document.createElement('div');
            notification.className = 'redirect-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-info-circle"></i>
                    <span>Bạn sẽ được chuyển đến trang đăng nhập trong 5 giây...</span>
                    <button onclick="cancelRedirect()" class="cancel-btn">Hủy</button>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => notification.classList.add('show'), 100);

            // Start countdown
            let countdown = 5;
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    window.location.href = '@Url.Action("Login")';
                }
            }, 1000);

            // Store interval for cancellation
            window.redirectInterval = countdownInterval;
        }

        function cancelRedirect() {
            if (window.redirectInterval) {
                clearInterval(window.redirectInterval);
            }
            const notification = document.querySelector('.redirect-notification');
            if (notification) {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }
        }
    </script>
}